---
import { getCollection } from "astro:content";
import { Image } from "astro:assets";
import BaseHead from "../../components/BaseHead.astro";
import Footer from "@packages/layouts/astro/Footer";
import FormattedDate from "../../components/FormattedDate.astro";
import Navbar from "@packages/layouts/astro/Navbar";
const entries = (await getCollection("changelog")).sort(
   (a, b) => b.data.date.valueOf() - a.data.date.valueOf(),
);

const title = "Changelog - Latest features and enhancements";
const description =
   "Stay up to date with the latest features, improvements, and updates.";
---

<!doctype html>
<html lang="en">
<head>
  <BaseHead title={title} description={description} />
  <style>
    main {
      width: calc(100% - 2rem);
      max-width: 100%;
      margin: 0;
    }
    
    .changelog-header {
      text-align: center;
      margin-bottom: 3rem;
      padding: 3rem 1rem 2rem;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .changelog-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1.5rem;
    }
    
    .changelog-badge-dot {
      width: 8px;
      height: 8px;
      background-color: rgb(var(--black));
      border-radius: 50%;
    }
    
    .changelog-badge-text {
      font-size: 0.875rem;
      color: rgb(var(--gray));
      font-weight: 500;
    }
    
    .changelog-header h1 {
      font-size: 3rem;
      font-weight: bold;
      margin: 0 0 1rem 0;
      color: rgb(var(--black));
      line-height: 1.2;
    }
    
    .changelog-header .brand {
      font-size: 1.25rem;
      color: rgb(var(--gray));
      margin-bottom: 2rem;
    }
    
    .changelog-links {
      display: flex;
      justify-content: center;
      gap: 2rem;
      font-size: 0.875rem;
    }
    
    .changelog-links a {
      color: rgb(var(--gray));
      text-decoration: underline;
      text-underline-offset: 4px;
    }
    
    .changelog-links a:hover {
      color: rgb(var(--black));
    }
    
    .changelog-container {
      display: flex;
      gap: 4rem;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem 4rem;
    }
    
    .timeline-sidebar {
      width: 200px;
      flex-shrink: 0;
    }
    
    .timeline-sidebar h2 {
      font-size: 0.875rem;
      font-weight: 500;
      color: rgb(var(--black));
      margin-bottom: 1.5rem;
    }
    
    .timeline-list {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    
    .timeline-list a {
      font-size: 0.875rem;
      color: rgb(var(--gray));
      text-decoration: none;
      transition: color 0.2s ease;
    }
    
    .timeline-list a:hover {
      color: rgb(var(--black));
    }
    
    .changelog-entries {
      flex: 1;
      max-width: 720px;
    }
    
    .changelog-entry {
      margin-bottom: 6rem;
    }
    
    .entry-hero-image {
      margin-bottom: 2rem;
      text-align: center;
    }
    
    .entry-hero-image img {
      border-radius: 12px;
      box-shadow: var(--box-shadow);
      width: 100%;
      height: auto;
      max-width: 720px;
    }
    
    .entry-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1.5rem;
    }
    
    .entry-badge-dot {
      width: 6px;
      height: 6px;
      background-color: rgb(var(--gray));
      border-radius: 50%;
    }
    
    .entry-badge-text {
      font-size: 0.875rem;
      color: rgb(var(--gray));
      font-weight: 400;
    }
    
    .entry-title {
      font-size: 2rem;
      font-weight: bold;
      color: rgb(var(--black));
      margin: 0 0 1.5rem 0;
      line-height: 1.3;
    }
    
    .entry-title a {
      color: inherit;
      text-decoration: none;
    }
    
    .entry-title a:hover {
      color: rgb(var(--accent));
    }
    
    .entry-description {
      font-size: 1rem;
      color: rgb(var(--gray-dark));
      line-height: 1.6;
      margin-bottom: 2rem;
    }
    
    .entry-author {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 0.875rem;
    }
    
    .author-info {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    
    .author-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      overflow: hidden;
      flex-shrink: 0;
    }
    
    .author-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .author-details .name {
      font-weight: 500;
      color: rgb(var(--black));
      margin-bottom: 0.125rem;
    }
    
    .author-details .role {
      color: rgb(var(--gray));
      font-size: 0.8125rem;
    }
    
    .author-date {
      color: rgb(var(--gray));
      font-size: 0.8125rem;
    }
    
    @media (max-width: 960px) {
      .changelog-container {
        flex-direction: column;
        gap: 2rem;
        padding: 0 1rem 2rem;
      }
      
      .timeline-sidebar {
        width: 100%;
      }
      
      .timeline-list {
        flex-direction: row;
        flex-wrap: wrap;
        gap: 1rem;
      }
      
      .changelog-header h1 {
        font-size: 2.5rem;
      }
      
      .entry-title {
        font-size: 1.75rem;
      }
      
      .entry-author {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
      }
    }
  </style>
</head>

<body>
  <Navbar />
  <main>
    <section>
      <div class="changelog-header">
        <div class="changelog-badge">
          <div class="changelog-badge-dot"></div>
          <span class="changelog-badge-text">Changelog</span>
        </div>
        <h1>Latest features and enhancements</h1>
        <p class="brand">Pixiol</p>
        <div class="changelog-links">
          <a href="#">Subscribe to updates ↗</a>
          <a href="#">Follow on Twitter ↗</a>
        </div>
      </div>
      
      <div class="changelog-container">
        <aside class="timeline-sidebar">
          <h2>Timeline</h2>
          <ul class="timeline-list">
            {entries.map((entry) => (
              <li>
                <a href={`/changelog/${entry.id}/`}>
                  <FormattedDate date={entry.data.date} />
                </a>
              </li>
            ))}
          </ul>
        </aside>
        
        <div class="changelog-entries">
          {entries.map((entry) => (
            <article class="changelog-entry">
              {entry.data.heroImage && (
                <div class="entry-hero-image">
                  <Image 
                    width={720} 
                    height={360} 
                    src={entry.data.heroImage || "/placeholder.svg"} 
                    alt={entry.data.title}
                  />
                </div>
              )}
              
              {entry.data.badge && (
                <div class="entry-badge">
                  <div class="entry-badge-dot"></div>
                  <span class="entry-badge-text">{entry.data.badge}</span>
                </div>
              )}
              
              <h2 class="entry-title">
                <a href={`/changelog/${entry.id}/`}>{entry.data.title}</a>
              </h2>
              
              <p class="entry-description">{entry.data.description}</p>
              
              {entry.data.author && (
                <div class="entry-author">
                  <div class="author-info">
                    <div class="author-avatar">
                      <Image 
                        width={32} 
                        height={32} 
                        src="/blog-placeholder-about.jpg" 
                        alt={entry.data.author.name}
                      />
                    </div>
                    <div class="author-details">
                      <div class="name">{entry.data.author.name}</div>
                      <div class="role">{entry.data.author.role}</div>
                    </div>
                  </div>
                  <div class="author-date">
                    <FormattedDate date={entry.data.date} />
                  </div>
                </div>
              )}
            </article>
          ))}
        </div>
      </div>
    </section>
  </main>
  <Footer />
</body>
</html>
