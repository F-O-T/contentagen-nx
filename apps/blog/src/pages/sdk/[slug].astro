---
export const prerender = true;
import BlogPost from "../../layouts/BlogPost.astro";
import { getAllBlogPosts, getBlogPostBySlug } from "../../lib/contentagen";

export async function getStaticPaths() {
   const posts = await getAllBlogPosts();
   return posts.map((post) => ({
      params: { slug: post.slug },
      props: { post },
   }));
}

interface Props {
   post: Awaited<ReturnType<typeof getBlogPostBySlug>>;
}

const { post } = Astro.props;

if (!post) {
   return Astro.redirect("/404");
}

// Mock frontmatter data to match BlogPost layout expectations
const frontmatter = {
   title: post.title,
   description: post.description,
   pubDate: post.pubDate,
   heroImage: post.heroImage,
   author: post.author,
};
---

<BlogPost {...frontmatter}>
   <div class="prose prose-lg dark:prose-invert max-w-none">
      <div class="mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800">
         <p class="text-sm text-blue-700 dark:text-blue-300 mb-2 font-medium">
            ðŸ“¡ SDK Content
         </p>
         <p class="text-xs text-blue-600 dark:text-blue-400">
            This content is dynamically loaded from ContentaGen API via SDK
         </p>
      </div>
      
      <div class="whitespace-pre-wrap" set:html={post.content} />
   </div>
</BlogPost>
