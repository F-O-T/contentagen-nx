import type { Collection, Metadata, ChromaClient } from "chromadb";

export interface AddToCollectionArgs {
   ids: string[];
   embeddings?: number[][];
   documents?: string[];
   metadatas?: Metadata[];
   uris?: string[];
}

export interface QueryCollectionArgs {
   queryEmbeddings: number[][];
   queryTexts?: string[];
   nResults?: number;
}

export const createCollection = async (
   client: ChromaClient,
   opts: { name: string; metadata?: Metadata },
) => {
   return await client.createCollection(opts);
};

export const getCollection = async (client: ChromaClient, name: string) => {
   return await client.getCollection({ name });
};

export const listCollections = async (client: ChromaClient) => {
   const collections = await client.listCollections();
   return collections.map((c: { name: string }) => c.name);
};

export const deleteCollection = async (client: ChromaClient, name: string) => {
   await client.deleteCollection({ name });
};

export const addToCollection = async (
   collection: Collection,
   args: AddToCollectionArgs,
) => {
   await collection.add(args);
};

export const queryCollection = async (
   collection: Collection,
   args: QueryCollectionArgs,
) => {
   return await collection.query(args);
};
